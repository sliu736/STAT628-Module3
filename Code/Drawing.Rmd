---
title: "628M3"
author: "Yifan Du"
date: "10/28/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(rjson)
library(jsonlite)
library(dplyr)
library(tidyr)
library(ggplot2)

```


```{r}
words_star_df <- read.csv('words_star.csv')
words_star_df <- words_star_df[,c(2,3)]
```




```{r}
counting_words<-c('membership','clean','machines','location','friendly','quiet','bad')

counting_by_star <- function(word) {
  words_star_word <- words_star_df[words_star_df$Word %>% grepl(pattern = word),]
  count_stars <- words_star_word %>%
    count(Star)
  return(count_stars$n)
}


star_df<-as.data.frame(matrix(nrow=5,ncol=0))
names<-c()

for (word in counting_words) {
  count<-counting_by_star(word)
  count<-count/dim(words_star_df)[1]
  if (length(count)==5) {
    star_df<-cbind(star_df,count)
    names<-cbind(names, word)
  } else {
    next
  }
}


colnames(star_df)<-names

dim(star_df)

```

```{r}
par(mfrow = c(2,5))



for (i in 1:length(names)) {
  barplot(star_df[,i], ylab='Word Freq', xlab = 'Stars', main=names[i])
}

```




